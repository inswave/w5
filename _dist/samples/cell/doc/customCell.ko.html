<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="W5" />
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/bootstrap/css/carousel.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/stylesheets/common.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/prism/prism.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/prism/prism-coy.css">
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-1212521-12', 'w5.io');
        ga('send', 'pageview');
    </script>
    <title>W5 : Custom Cell</title>
</head>

<body>
    <!-- HEADER -->
    <header id="header_wrap">
        <div class="navbar-wrapper">
            <div class="navbar navbar-inverse navbar-static-top" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="sr-only">Toggle navigation</span>  <span class="icon-bar"></span>  <span class="icon-bar"></span>  <span class="icon-bar"></span> 
                    </button>
                    <a class="navbar-brand" href="../../../../index.html">
                        <img src="../../../resources/images/w5_w.png" class="logo" alt="W5" />
                    </a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <!--li class="active"><a href="#">Getting started</a></li>          <li class="divider"></li>          <li class="dropdown-header">Nav header</li-->
                        <li><a href="../../../gettingStarted/gettingStarted/doc/gettingStarted.html">Getting started</a>
                        </li>
                        <li><a href="../../../samples/basic/doc/createW5Grid.html">Samples</a>
                        </li>
                        <li><a href="#" onclick="openAlert(this);">API Docs</a>
                        </li>
                        <!--li class="dropdown"-->
                        <li> <a href="#" onclick="openAlert(this);">Support</a> 
                            <!--a href="" class="dropdown-toggle" data-toggle="dropdown">Support<b class="caret"></b></a>            <ul class="dropdown-menu">              <li><a href="">Forum</a></li>              <li><a href="">Purchase Options</a></li>            </ul-->
                        </li>
                        <!--li class="dropdown"-->
                        <li> <a href="#" onclick="openAlert(this);">About</a> 
                            <!--a href="" class="dropdown-toggle" data-toggle="dropdown">About<b class="caret"></b></a>            <ul class="dropdown-menu">              <li><a href="">Company</a></li>              <li><a href="">Contact us</a></li>            </ul-->
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="visual">
            <h1>Sample</h1> 
            <p>Learn how to use and how powerful the w5 Grid is</p>
        </div>
    </header>
    <!-- MAIN CONTENT -->
    <div id="main_content" class="inner row content">
        <aside class="lnb">
            <nav id="lnbList">
                <h1>Sample</h1> 
                <!--ul>                <li><a href=""></a></li>                </ul-->
            </nav>
        </aside>
        <article class="contents">
            <section>
                <h1 id="custom-cell">Custom Cell</h1>
                <p>조건, 데이타 변형, Node 조작등을 통해 사용자 정의 Cell 을 정의할 수 있다. 방식은 아래와 같이 크게 3가지가 있다.</p>
                <ul>
                    <li>template</li>
                    <li>expression</li>
                    <li>nodeFormatter</li>
                </ul>
                <h2 id="template">Template</h2>
                <p>주로 displayType 이 <code class="language-javascript">text</code> 인 Cell 에 사용된다.
                    <br><a href="http://underscorejs.org/#template">Underscore.js</a> 의 Template 을 이용한다.
                    <br>String 또는 컴파일된 Template Function 을 지정할 수 있다.</p>
                <h3 id="template-function-elements">Template Function Elements</h3>
                <p>Template Function Elements 은 다음과 같다.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Elements</th>
                            <th>내용</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt;%= … %&gt;</td>
                            <td>변수 삽입</td>
                        </tr>
                        <tr>
                            <td>&lt;% … %&gt;</td>
                            <td>execute JavaScript code</td>
                        </tr>
                        <tr>
                            <td>&lt;%- … %&gt;</td>
                            <td>HTML-escaped</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="-example-01-"><a href="#-01">Example</a></h3>
                <p>Template 의 data 변수는 Model 에서 관리하는 해당 Cell 의 data 이다.</p>
                <pre><code class="language-javascript">{
  id: "A",
  // 데이타의 값이 0 보다 크거나 같으면 파란색으로 그렇지 않으면 붉은 색으로 표시
  template: "&lt;span style=&apos;color:&lt;% if(data &gt;= 0) {%&gt;blue&lt;%} else {%&gt;red&lt;%}%&gt;&apos;&gt;&lt;%=data%&gt;&lt;/span&gt;"
}, {
  id: "B",
  // 100 을 기준으로 A 컬럼과 동일하게 색상 표시 및 화살표 표시
  template: "&lt;span style=&apos;color:&lt;% if(data &gt;= 100) {%&gt;blue&lt;%} else {%&gt;red&lt;%}%&gt;&apos;&gt;&lt;% if(data &gt;= 100) {%&gt;△&lt;%} else {%&gt;▽&lt;%}%&gt;&lt;%=data%&gt;&lt;/span&gt;"
}
</code></pre>
                <h2 id="expression">Expression</h2>
                <p>실제 Model 에서 관리하는 Data 뿐만 아니라 메타 정보나 데이타 간 연산의 결과를 Cell 의 값으로 표현할 수 있다.</p>
                <h3 id="expression-function-parameter">Expression Function Parameter</h3>
                <p>options(Object) 파라미터를 갖는다.
                    <br>options 객체는 rowIndex, colId, attributes 를 properties 로 구성되어 있다.
                    <br>attributes 는 row 에 binding 된 Backbone.Model 객체에 해당하는 JSONObject 이다.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>내용</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>rowIndex</td>
                            <td>row index</td>
                        </tr>
                        <tr>
                            <td>colId</td>
                            <td>column ID</td>
                        </tr>
                        <tr>
                            <td>attributes</td>
                            <td>해당 row 의 데이타</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="-">데이타 조작</h3>
                <h4 id="-1">예제 1</h4>
                <p>Model 의 데이타를 Cell 의 값으로 표현하는 대신 Cell 의 정보(row index)를 이용하여 row number 를 표시하는 예제이다.</p>
                <pre><code class="language-javascript">expression: function(options) {
    return options.rowIndex;
}
</code></pre>
                <h4 id="-2">예제 2</h4>
                <p>Cell 속한 Row 의 다른 컬럼들 값을 연산하여 결과를 표현한다.</p>
                <pre><code class="language-javascript">expression: function(options) {
    // A 와 B 컬럼 데이타의 합을 SUM 컬럼의 값으로 표시한다.
    return options.attributes["A"] + options.attributes["B"];
}
</code></pre>
                <h3 id="-01">직접 해보세요! 01</h3>
                <p>
                    <p data-height="400" data-theme-id="0" data-slug-hash="Fjayg" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/w5/pen/Fjayg/'>W5Grid - 07 Custom Cell</a> by w5 (<a href='http://codepen.io/w5'>@w5</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
                </p>
                <script async src="//codepen.io/assets/embed/ei.js"></script>

                <h3 id="options-">Options 및 메타 정보 조작</h3>
                <p>expression 을 이용하여 그리드 구성 요소( Column, Cell등) 의 옵션 및 메타 정보를 제어할 수 있다.</p>
                <h4 id="-">주의사항</h4>
                <ul>
                    <li><code class="language-javascript">silent</code> 옵션을 true 로 주어 화면 중복 갱신을 방지한다. - 성능 개선</li>
                    <li>expression 은 화면 갱신으로 Cell 이 새로 그려질 때마다 호출되는 함수로 필요한 경우 Closure 로 구성한다.
                        <ul>
                            <li>outer function 은 그리드 생성 또는 reset 시 한 번만 실행된다.</li>
                            <li>inner function 은 Cell 이 새로 그려질 때(예: 스크롤)마다 실행된다. - 해당 Cell 에 표시될 data 를 return</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="example-01">Example 01</h4>
                <p>그리드 생성 시 <code class="language-javascript">col0</code> 컬럼의 데이타를 기준으로 해당 컬럼(obj 를 메타 정보로 가지고 있는 컬럼)의 displayType 을 설정한다.</p>
                <pre><code class="language-javascript">obj.expression = function ( options ) {
    // options 파라미터의 attributes(JSONObject) 에서 `col0` 의 data 를 얻어온다.
    displayType = options.attributes['col0'];

    // Expression Function 의 `this` context 는 grid 를 참조한다.
    // options 파라미터의 rowIndex, colId 로 expression 이 실행될 cell 을 얻어온다.
    // set 메소드를 이용해서 `col1` 컬럼의 displayType 를 설정한다.
    this.cell( options.rowIndex, options.colId ).set( 'displayType', displayType, { silent: true } );

    return function (options) {
        return options.attributes[options.colId];
    }
};
</code></pre>
                <h4 id="example-02">Example 02</h4>
                <p><code class="language-javascript">col2</code> 컬럼의 data 를 기준으로 <code class="language-javascript">col3</code> 컬럼의 select options 에 지정될 data 를 필터링한다.
                    <br><a href="#-02">아래 예제</a>에서 동일한 필터링을 <code class="language-javascript">col2</code> 의 change event callback handler 에서도 실행함으로써 <code class="language-javascript">col2</code> 컬럼의 선택된 아이템이 변경되면 <code class="language-javascript">col3</code> 컬럼의
                    select options 가 동적으로 적용되는 것을 확인할 수 있다.</p>
                <pre><code class="language-javascript">obj.expression = function ( options ) {
    this.cell( options.rowIndex, options.colId ).set( 'options', filterOptions( options.attributes['col2'] ), { silent: true } );

    return function (options) {
        return options.attributes[options.colId];
    }
};
</code></pre>
                <h2 id="nodeformatter">nodeFormatter</h2>
                <p>Node 를 직접 핸들링하여 3rd Party 등의 사용자 Widget 을 구성한다.</p>
                <h3 id="nodeformatter-function-parameters">nodeFormatter Function Parameters</h3>
                <p>nodeFormatter Function 의 파라미터는 다음과 같다.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>td</td>
                            <td>이 Cell 을 위한 &lt;td&gt; Node 이다.</td>
                        </tr>
                        <tr>
                            <td>content</td>
                            <td>&lt;td&gt; Node 하위에 위치하는 Widget 이다.</td>
                        </tr>
                        <tr>
                            <td>data</td>
                            <td>Cell 에 바인딩된 Data 이다.</td>
                        </tr>
                        <tr>
                            <td>record</td>
                            <td>Cell 이 존재하는 Row 를 대표하는 Model 이다. - Backbone.Model</td>
                        </tr>
                        <tr>
                            <td>row</td>
                            <td>Row 의 Index 이다.</td>
                        </tr>
                        <tr>
                            <td>column</td>
                            <td>Column 의 ID 이다.</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="-"><strong>주의 사항</strong></h3>
                <p><strong>nodeFormatter</strong> 는 Custom Cell 을 만드는 가장 강력한 방식임에도 불구하고 Node 를 직접 접근하여 수정하는 것임으로 성능상 이슈가 발생할 수 있다.
                    <br>따라서 꼭 필요한 경우, 주의해서 사용하여야 한다.</p>
                <h4 id="nodeformatter-destroy">nodeFormatter.destroy</h4>
                <p>스크롤 등으로 화면 갱신이 이뤄져서 특정 Cell 이 화면에서 사라지면 해당 Cell 안에 Widget 은 생명 주기를 마친다.
                    <br>생명 주기를 마칠 때 해당 Cell 을 대표하는 &lt;td&gt; Node 하위는 clear 작업이 자동으로 수행된다.
                    <br>Kendo UI DateTimePicker 처럼 &lt;td&gt; Node 하위가 아닌(&lt;body&gt;) 위치에 Elements(div) - 달력 팝업을 위한 - 를 생성하고 객체 생성 시 마다 반복적으로 Elements 를 생성하는 경우, Memory Leak 의 위험성이 있다.
                    <br>참고로 jQueryUI 는 하나의 Elements(div) 를 공유함.
                    <br>이 때는 nodeFormatter.destroy function 을 이용하여 직접 clear 을 수행해 주어야 한다.
                    <br>destroy function 의 파라미터는 nodeFormatter Function 의 파라미터에서 2번째 파라미터인 content 만 없고 나머지는 동일하다.</p>
                <h3 id="examples">Examples</h3>
                <h4 id="jquery-ui">jQuery UI</h4>
                <p>jQuery UI 의 Datepicker 를 사용한 예제이다.</p>
                <pre><code class="language-javascript">// input 의 값을 기준으로 달력 팝업의 날짜가 선택된다.
obj.template = "&lt;input type=&apos;text&apos; value=&apos;&lt;%=data%&gt;&apos;/&gt;";
obj.nodeFormatter = function( td, content, data, record, row, column ) {

  // content 파라미터는 template 으로 정의한 input element 이다.
  // input element 에 jQueryUI datepicker API 를 이용하여 DatePicker 를 생성한다.
  $(content).datepicker({

    // DatePicker 에 정의된 onSelect 이벤트의 핸들러를 통해 날짜가 선택되었을 때 값 - dateText - 을 Model(Backbone.Model) 에 set 한다.
    onSelect: function ( dateText, calInst ) {
      record.set( column, dateText );
    }
  });
}
</code></pre>
                <h4 id="kendo-ui">Kendo UI</h4>
                <p>Kendo UI 의 DateTimePicker 를 이용한 예제이다.
                    <br>destroy API 는 <a href="http://docs.telerik.com/kendo-ui/api/framework/widget#methods-destroy">여기</a>를 참조한다.</p>
                <pre><code class="language-javascript">obj.template = "&lt;input type=&apos;text&apos;/&gt;";
obj.nodeFormatter = function( td, content, data, record, row, column ) {

  // content 파라미터는 template 으로 정의한 input element 이다.
  $(content).kendoDateTimePicker({

    // DateTimePicker 생성 시 value property 에 날짜 정보를 전달한다.
    // value property 에 전달된 값은 input element 에 해당 날짜가 표시되고 달력 팝업시 해당 일자가 선택된다.
    value: data,

    // Kendo UI DateTimePicker 에 정의된 change 이벤트의 핸들러에서 Model(Backbone.Model) 과 동기화한다.
    change: function() {
      // this.value() 를 통해 DateTimePicker 의 값을 얻어와서 Model에 set 한다.
      record.set( column, this.value() );
    }
  });
};
obj.nodeFormatter.destroy = function ( td, data, record, row, column ) {

    // DateTimePicker 를 생성한 input Element 에서 data(jQuery API) 를 이용하여 객체를 얻어온다.
    var picker = $(td).find('input').data('kendoDateTimePicker');

    if ( picker ) {
        // Kendo UI 에서 제공하는 destroy API를 이용해서 clear 작업을 수행한다.
        picker.destroy();
    }
};
</code></pre>
                <h3 id="-02">직접 해보세요! 02</h3>
                <p>
                    <p data-height="490" data-theme-id="0" data-slug-hash="ohebw" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/w5/pen/ohebw/'>W5Grid - 05 DisplayType</a> by w5 (<a href='http://codepen.io/w5'>@w5</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
                </p>
                <script async src="//codepen.io/assets/embed/ei.js"></script>
            </section>
            <section>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'w5-io'; /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
                </noscript> <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> 
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'w5-io'; /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var s = document.createElement('script');
                        s.async = true;
                        s.type = 'text/javascript';
                        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                    }());
                </script>
            </section>
        </article>
    </div>
    <!-- FOOTER  -->
    <div id="footer_wrap">
        <footer class="inner clearfix">
            <div style="width:255px; float:right;">
                <a href="//plus.google.com/u/0/105292818602737285330?prsrc=3" rel="publisher" target="_blank" style="text-decoration:none; display:block; float:left; width:25px;">
                    <img src="//ssl.gstatic.com/images/icons/gplus-16.png" alt="Google+" style="border:0;width:16px;height:16px;" />
                </a> <a href="https://twitter.com/share" class="twitter-share-button" data-via="w5_io">Tweet</a> 
                <script>
                    ! function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0],
                            p = /^http:/.test(d.location) ? 'http' : 'https';
                        if (!d.getElementById(id)) {
                            js = d.createElement(s);
                            js.id = id;
                            js.src = p + '://platform.twitter.com/widgets.js';
                            fjs.parentNode.insertBefore(js, fjs);
                        }
                    }(document, 'script', 'twitter-wjs');
                </script> <a href="https://twitter.com/w5_io" class="twitter-follow-button" data-show-count="false">Follow @w5_io</a> 
                <script>
                    ! function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0],
                            p = /^http:/.test(d.location) ? 'http' : 'https';
                        if (!d.getElementById(id)) {
                            js = d.createElement(s);
                            js.id = id;
                            js.src = p + '://platform.twitter.com/widgets.js';
                            fjs.parentNode.insertBefore(js, fjs);
                        }
                    }(document, 'script', 'twitter-wjs');
                </script>
            </div>
        </footer>
    </div>
    <script src="../../../resources/js/jquery-1.11.1.min.js"></script>
    <script src="../../../resources/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../../resources/prism/prism.js"></script>
    <script type="text/javascript">
        function openAlert(target) {
            var alertParent = $("#header_wrap"),
                alert, alertLeft = 0;
            alert = $("<div class='alert alert-warning alert-dismissable' style='position:absolute; top:100px; z-index:20;'>" + "<button type='button' class='close' data-dismiss='alert' aria-hidden='true'>&times;</button>" + "<strong>Sorry!</strong> '" + $(target).text() + "' is under construction." + "</div>");
            alertParent.append(alert);
            alertLeft = alertParent.width() / 2 - alert.width() / 2;
            alert.css("left", alertLeft);
        }
        var lnb = $("#lnbList"),
            menuName = lnb.find("h1").text(),
            menuList = $("<h2>Basic</h2>" + "<ul>" + "<li><a href='../../basic/doc/createW5Grid.html'>Creating W5 Grid</a></li>" + "<li><a href='../../basic/doc/convertTable.html'>Converting a table to a W5 grid</a></li>" + "<li><a href='../../basic/doc/get-set.html'>.get()/.set() API</a></li>" + "<li><a href='../../basic/doc/requireJS.html'>RequireJS</a></li>" + "</ul>" + "<h2>Column</h2>" + "<ul>" + "<li><a href='../../column/doc/adjustColumn.html'>Adjust Column Width</a></li>" + "<li><a href='../../column/doc/hideShowColumn.html'>Hide/Show Column</a></li>" + "<li><a href='../../column/doc/moveColumn.html'>Moving a column </a></li>" + "<li><a href='../../column/doc/frozenColumn.html'>Frozen column</a></li>" + "<li><a href='../../column/doc/flex.html'>Flexible column</a></li>" + "</ul>" + "<h2>Navigation</h2>" + "<ul>" + "<li><a href='../../navigation/doc/scroll.html'>Scroll</a></li>" + "<li><a href='../../navigation/doc/scrollArea.html'>Scroll Area</a></li>" + "<li><a href='../../navigation/doc/wheel.html'>Wheel</a></li>" + "<li><a href='../../navigation/doc/keyboardNavigation.html'>Keyboard Navigation</a></li>" + "</ul>" + "<h2>Style</h2>" + "<ul>" + "<li><a href='../../style/doc/concept.html'>Concept</a></li>" + "<li><a href='../../style/doc/cssAPI.html'>CSS API</a></li>" + "</ul>" + "<h2>Cell</h2>" + "<ul>" + "<li><a href='../../cell/doc/inlineEdit.html'>Inline Edit</a></li>" + "<li><a href='../../cell/doc/displayType.html'>Display Type</a></li>" + "<li><a href='../../cell/doc/customCell.html'>Custom Cell</a></li>" + "<li><a href='../../cell/doc/dataType.html'>Data Type</a></li>" + "</ul>" + "<h2>Data</h2>" + "<ul>" + "<li><a href='../../data/doc/defaults.html'>Defaults</a></li>" + "<li><a href='../../data/doc/expression_format.html'>Expression</a></li>" + "<li><a href='../../data/doc/processData.html'>Process Data</a></li>" + "</ul>" + "<h2>Sort</h2>" + "<ul>" + "<li><a href='../../sort/doc/sort.html'>Sort</a></li>" + "</ul>");
        if (menuName === "Sample") {
            lnb.append(menuList);
        }
    </script>
</body>

</html>