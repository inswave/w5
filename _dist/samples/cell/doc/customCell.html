<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="W5" />
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/bootstrap/css/carousel.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/stylesheets/stylesheet.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/stylesheets/common.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/prism/prism.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./../../../resources/prism/prism-coy.css">
    <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o), m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-1212521-12', 'w5.io');
        ga('send', 'pageview');
    </script>
    <title>W5 : Custom Cell</title>
</head>

<body>
    <!-- HEADER -->
    <header id="header_wrap">
        <div class="navbar-wrapper">
            <div class="navbar navbar-inverse navbar-static-top" role="navigation">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse"> <span class="sr-only">Toggle navigation</span>  <span class="icon-bar"></span>  <span class="icon-bar"></span>  <span class="icon-bar"></span> 
                    </button>
                    <a class="navbar-brand" href="../../../../index.html">
                        <img src="../../../resources/images/w5_w.png" class="logo" alt="W5" />
                    </a>
                </div>
                <div class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <!--li class="active"><a href="#">Getting started</a></li>          <li class="divider"></li>          <li class="dropdown-header">Nav header</li-->
                        <li><a href="../../../gettingStarted/gettingStarted/doc/gettingStarted.html">Getting started</a>
                        </li>
                        <li><a href="../../../samples/basic/doc/createW5Grid.html">Samples</a>
                        </li>
                        <li><a href="#" onclick="openAlert(this);">API Docs</a>
                        </li>
                        <!--li class="dropdown"-->
                        <li> <a href="#" onclick="openAlert(this);">Support</a> 
                            <!--a href="" class="dropdown-toggle" data-toggle="dropdown">Support<b class="caret"></b></a>            <ul class="dropdown-menu">              <li><a href="">Forum</a></li>              <li><a href="">Purchase Options</a></li>            </ul-->
                        </li>
                        <!--li class="dropdown"-->
                        <li> <a href="#" onclick="openAlert(this);">About</a> 
                            <!--a href="" class="dropdown-toggle" data-toggle="dropdown">About<b class="caret"></b></a>            <ul class="dropdown-menu">              <li><a href="">Company</a></li>              <li><a href="">Contact us</a></li>            </ul-->
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="visual">
            <h1>Sample</h1> 
            <p>Learn how to use and how powerful the w5 Grid is</p>
        </div>
    </header>
    <!-- MAIN CONTENT -->
    <div id="main_content" class="inner row content">
        <aside class="lnb">
            <nav id="lnbList">
                <h1>Sample</h1> 
                <!--ul>                <li><a href=""></a></li>                </ul-->
            </nav>
        </aside>
        <article class="contents">
            <section>
                <h1 id="custom-cell">Custom Cell</h1>
                <p>A user-defined cell can be created using "conditions", "data modification", and "node manipulation". There are three methods as described below.</p>
                <ul>
                    <li>template</li>
                    <li>expression</li>
                    <li>nodeFormatter</li>
                </ul>
                <h2 id="template">Template</h2>
                <p>Mainly used for the cell whose displayType is <code class="language-javascript">Text</code>.
                    <br>The template in the <a href="http://underscorejs.org/#template">Underscore.js</a> is used.
                    <br>A string or compiled template function can be specified.</p>
                <h3 id="template-function-elements">Template Function Elements</h3>
                <p>The following section describes template function elements.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Elements</th>
                            <th>Contents</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>&lt;%= … %&gt;</td>
                            <td>Insert a variable</td>
                        </tr>
                        <tr>
                            <td>&lt;% … %&gt;</td>
                            <td>execute JavaScript code</td>
                        </tr>
                        <tr>
                            <td>&lt;%- … %&gt;</td>
                            <td>HTML-escaped</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="-example-give-it-a-try-01-"><a href="#give-it-a-try-01">Example</a></h3>
                <p>The data variable of the template is the data of the cell in question managed by the model.</p>
                <pre><code class="language-javascript">{
  id: "A",
  // Displayed in blue, if the data value is greater than or equal to 0. Otherwise, displayed in red.
  template: "&lt;span style=&apos;color:&lt;% if(data &gt;= 0) {%&gt;blue&lt;%} else {%&gt;red&lt;%}%&gt;&apos;&gt;&lt;%=data%&gt;&lt;/span&gt;"
}, {
  id: "B",
  // Indicate the same color and arrow with the column A, based on 100.
  template: "&lt;span style=&apos;color:&lt;% if(data &gt;= 100) {%&gt;blue&lt;%} else {%&gt;red&lt;%}%&gt;&apos;&gt;&lt;% if(data &gt;= 100) {%&gt;△&lt;%} else {%&gt;▽&lt;%}%&gt;&lt;%=data%&gt;&lt;/span&gt;"
}
</code></pre>
                <h2 id="expression">Expression</h2>
                <p>The data managed by the actual model, as well as the result of arithmetic operation between meta information and data can be expressed as a cell value.</p>
                <h3 id="expression-function-parameter">Expression Function Parameter</h3>
                <p>options(Object) Has a parameter.
                    <br>The options object has rowIndex and colId, attributes as properties.
                    <br>Attributes are the JSON object corresponding to the Backbone.Model object, which is bound to a row.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Parameter</th>
                            <th>Contents</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>rowIndex</td>
                            <td>row index</td>
                        </tr>
                        <tr>
                            <td>colId</td>
                            <td>column ID</td>
                        </tr>
                        <tr>
                            <td>attributes</td>
                            <td>Data of the row in question</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="data-modification">Data modification</h3>
                <h4 id="example-1">Example 1</h4>
                <p>An example that displays the row number using the cell information (row index), instead of expressing the model data as a cell value.</p>
                <pre><code class="language-javascript">expression: function(options) {
    return options.rowIndex;
}
</code></pre>
                <h4 id="example-2">Example 2</h4>
                <p>Calculate the value of other columns on the row, which belongs to the cell, and displays the result.</p>
                <pre><code class="language-javascript">expression: function(options) {
    // Displays the sum of A and B column data as a value for the `SUM` column.
    return options.attributes["A"] + options.attributes["B"];
}
</code></pre>
                <h3 id="give-it-a-try-01">Give it a try! 01</h3>
                <p>
                    <p data-height="400" data-theme-id="0" data-slug-hash="Fjayg" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/w5/pen/Fjayg/'>W5Grid - 07 Custom Cell</a> by w5 (<a href='http://codepen.io/w5'>@w5</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
                </p>
                <script async src="//codepen.io/assets/embed/ei.js"></script>

                <h3 id="options-and-meta-information-manipulation">Options and meta information manipulation</h3>
                <p>Options and meta information on grid components (column, cell, etc.) can be controlled, using an expression.</p>
                <h4 id="caution">Caution</h4>
                <ul>
                    <li>Prevent duplicated screen refreshing by setting <code class="language-javascript">silent</code> option to true, to improve the performance.</li>
                    <li>expression is a function called each time the cell is newly drawn due to screen refreshing. If necessary, compose with Closure.
                        <ul>
                            <li>The outer function is executed once when a grid is created or reset.</li>
                            <li>The inner function is executed each time the cell is newly drawn (e.g., scrolling), and returns the data that will be displayed on the cell in question.</li>
                        </ul>
                    </li>
                </ul>
                <h4 id="example-01">Example 01</h4>
                <p>Set the displayType of the column in question (column having obj as meta information), based on the data of the <code class="language-javascript">col0</code> column when creating a grid.</p>
                <pre><code class="language-javascript">obj.expression = function ( options ) {
    // Get the `col0` data from options parameter attributes (JSONObject).
    displayType = options.attributes['col0'];

    // The `this` context in the expression function refers to the grid.
    // The `options` parameter `rowIndex` and `colId`, which gets the cell that the expression will be executed.
    // Set the `displayType` of the `col1` column, using the `set` method.
    this.cell( options.rowIndex, options.colId ).set( 'displayType', displayType, { silent: true } );

    return function (options) {
        return options.attributes[options.colId];
    }
};
</code></pre>
                <h4 id="example-02">Example 02</h4>
                <p>Filter out the data that will be assigned to the select options of the <code class="language-javascript">col3</code> column, based on the data of the <code class="language-javascript">col2</code> column.
                    <br>In the <a href="#give-it-a-try-02">below example</a>, we can see that the select options of the <code class="language-javascript">col3</code> column is applied dynamically, if the selected item of the <code class="language-javascript">col2</code> column
                    is changed, by executing same filtering on the change event callback handler of <code class="language-javascript">col2</code>.</p>
                <pre><code class="language-javascript">obj.expression = function ( options ) {
    this.cell( options.rowIndex, options.colId ).set( 'options', filterOptions( options.attributes['col2'] ), { silent: true } );

    return function (options) {
        return options.attributes[options.colId];
    }
};
</code></pre>
                <h2 id="nodeformatter">nodeFormatter</h2>
                <p>Compose the user widget (3rd party, etc.), by handling nodes directly.</p>
                <h3 id="nodeformatter-function-parameters">nodeFormatter Function Parameters</h3>
                <p>The below section shows the parameter of the nodeFormatter function.</p>
                <table>
                    <thead>
                        <tr>
                            <th>Property</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>td</td>
                            <td>The &lt;td&gt; node for this cell.</td>
                        </tr>
                        <tr>
                            <td>content</td>
                            <td>The widget located below the &lt;td&gt; node.</td>
                        </tr>
                        <tr>
                            <td>data</td>
                            <td>The data bound to the cell.</td>
                        </tr>
                        <tr>
                            <td>record</td>
                            <td>The model that represents the row with a cell. - Backbone.Model</td>
                        </tr>
                        <tr>
                            <td>row</td>
                            <td>Row index.</td>
                        </tr>
                        <tr>
                            <td>column</td>
                            <td>Column ID.</td>
                        </tr>
                    </tbody>
                </table>
                <h3 id="-caution-"><strong>Caution</strong></h3>
                <p>Even though <strong>nodeFormatter</strong> is the strongest way of creating a custom cell, it can cause a performance issue, as it directly accesses and modifies the node. Therefore, use with care when it is required.</p>
                <h4 id="nodeformatter-destroy">nodeFormatter.destroy</h4>
                <p>If a particular cell disappears from the screen due to screen refreshing (due to scrolling, etc.), the widget in the cell in question completes its life cycle.
                    <br>When the lifecycle is completed, the sub node of &lt;td&gt; that represents the cell in question will be automatically cleared.
                    <br>Like Kendo UI DateTimePicker, if elements (div) (for calendar pop-up) is created at the location of (
                    <% htmlEncoder(v9), instead of the sub node of &lt;td&gt;, and the elements are created repetitively whenever an object is created,
                    there is a risk of the memory leak.<br>For reference, jQueryUI shares one element (div).
                        <br>At this time, the cell should be manually cleared using the nodeFormatter.destroy function.
                        <br>The parameter of the destroy function is same with that of the nodeFormatter function, except the second parameter (<code class="language-javascript">content</code>).</p>
                <h3 id="examples">Examples</h3>
                <h4 id="jquery-ui">jQuery UI</h4>
                <p>This example uses the Datepicker jQuery UI.</p>
                <pre><code class="language-javascript">// The date of the calendar pop-up is selected, based on the input value.
obj.template = "&lt;input type=&apos;text&apos; value=&apos;&lt;%=data%&gt;&apos;/&gt;";
obj.nodeFormatter = function( td, content, data, record, row, column ) {

  // The `content` parameter is an input element defined with a template.
  // Create DatePicker in the input element, using the jQueryUI datepicker API.
  $(content).datepicker({

    // Set the value (`dateText`), which is obtained when the date selected using the handler of the `onSelect` event defined in DatePicker, to the model (Backbone.Model).
    onSelect: function ( dateText, calInst ) {
      record.set( column, dateText );
    }
  });
}
</code></pre>
                <h4 id="kendo-ui">Kendo UI</h4>
                <p>This example uses the DateTimePicker Kendo UI.</p>
                <pre><code class="language-javascript">obj.template = "&lt;input type=&apos;text&apos;/&gt;";
obj.nodeFormatter = function( td, content, data, record, row, column ) {

  // The `content` parameter is an input element defined with a template.
  $(content).kendoDateTimePicker({

    // Pass the date information over to the value property, when creating DateTimePicker.
    // The value passed over to the value property will be selected, when the date in question is displayed on the input element and a calendar pop-up appears.
    value: data,

    // The handler of the `change` event defined in the DateTimePicker Kendo UI synchronizes with the model (Backbone.Model).
    change: function() {
      // Gets the DateTimePicker value using this.value() sets it in the model.
      record.set( column, this.value() );
    }
  });
};
obj.nodeFormatter.destroy = function ( td, data, record, row, column ) {

    // Gets an object from the input element that has created DateTimePicker, using data(jQuery API).
    var picker = $(td).find('input').data('kendoDateTimePicker');

    if ( picker ) {
        // Clears the object using the destroy API provided by the Kendo UI.
        picker.destroy();
    }
};
</code></pre>
                <h3 id="give-it-a-try-02">Give it a try! 02</h3>
                <p>
                    <p data-height="490" data-theme-id="0" data-slug-hash="ohebw" data-default-tab="result" class='codepen'>See the Pen <a href='http://codepen.io/w5/pen/ohebw/'>W5Grid - 05 DisplayType</a> by w5 (<a href='http://codepen.io/w5'>@w5</a>) on <a href='http://codepen.io'>CodePen</a>.</p>
                </p>
                <script async src="//codepen.io/assets/embed/ei.js"></script>
            </section>
            <section>
                <div id="disqus_thread"></div>
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'w5-io'; /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var dsq = document.createElement('script');
                        dsq.type = 'text/javascript';
                        dsq.async = true;
                        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                    })();
                </script>
                <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
                </noscript> <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a> 
                <script type="text/javascript">
                    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                    var disqus_shortname = 'w5-io'; /* * * DON'T EDIT BELOW THIS LINE * * */
                    (function() {
                        var s = document.createElement('script');
                        s.async = true;
                        s.type = 'text/javascript';
                        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                    }());
                </script>
            </section>
        </article>
    </div>
    <!-- FOOTER  -->
    <div id="footer_wrap">
        <footer class="inner clearfix">
            <div style="width:255px; float:right;">
                <a href="//plus.google.com/u/0/105292818602737285330?prsrc=3" rel="publisher" target="_blank" style="text-decoration:none; display:block; float:left; width:25px;">
                    <img src="//ssl.gstatic.com/images/icons/gplus-16.png" alt="Google+" style="border:0;width:16px;height:16px;" />
                </a> <a href="https://twitter.com/share" class="twitter-share-button" data-via="w5_io">Tweet</a> 
                <script>
                    ! function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0],
                            p = /^http:/.test(d.location) ? 'http' : 'https';
                        if (!d.getElementById(id)) {
                            js = d.createElement(s);
                            js.id = id;
                            js.src = p + '://platform.twitter.com/widgets.js';
                            fjs.parentNode.insertBefore(js, fjs);
                        }
                    }(document, 'script', 'twitter-wjs');
                </script> <a href="https://twitter.com/w5_io" class="twitter-follow-button" data-show-count="false">Follow @w5_io</a> 
                <script>
                    ! function(d, s, id) {
                        var js, fjs = d.getElementsByTagName(s)[0],
                            p = /^http:/.test(d.location) ? 'http' : 'https';
                        if (!d.getElementById(id)) {
                            js = d.createElement(s);
                            js.id = id;
                            js.src = p + '://platform.twitter.com/widgets.js';
                            fjs.parentNode.insertBefore(js, fjs);
                        }
                    }(document, 'script', 'twitter-wjs');
                </script>
            </div>
        </footer>
    </div>
    <script src="../../../resources/js/jquery-1.11.1.min.js"></script>
    <script src="../../../resources/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../../resources/prism/prism.js"></script>
    <script type="text/javascript">
        function openAlert(target) {
            var alertParent = $("#header_wrap"),
                alert, alertLeft = 0;
            alert = $("<div class='alert alert-warning alert-dismissable' style='position:absolute; top:100px; z-index:20;'>" + "<button type='button' class='close' data-dismiss='alert' aria-hidden='true'>&times;</button>" + "<strong>Sorry!</strong> '" + $(target).text() + "' is under construction." + "</div>");
            alertParent.append(alert);
            alertLeft = alertParent.width() / 2 - alert.width() / 2;
            alert.css("left", alertLeft);
        }
        var lnb = $("#lnbList"),
            menuName = lnb.find("h1").text(),
            menuList = $("<h2>Basic</h2>" + "<ul>" + "<li><a href='../../basic/doc/createW5Grid.html'>Creating W5 Grid</a></li>" + "<li><a href='../../basic/doc/convertTable.html'>Converting a table to a W5 grid</a></li>" + "<li><a href='../../basic/doc/get-set.html'>.get()/.set() API</a></li>" + "<li><a href='../../basic/doc/requireJS.html'>RequireJS</a></li>" + "</ul>" + "<h2>Column</h2>" + "<ul>" + "<li><a href='../../column/doc/adjustColumn.html'>Adjust Column Width</a></li>" + "<li><a href='../../column/doc/hideShowColumn.html'>Hide/Show Column</a></li>" + "<li><a href='../../column/doc/moveColumn.html'>Moving a column </a></li>" + "<li><a href='../../column/doc/frozenColumn.html'>Frozen column</a></li>" + "</ul>" + "<h2>Navigation</h2>" + "<ul>" + "<li><a href='../../navigation/doc/keyboardNavigation.html'>Keyboard Navigation</a></li>" + "</ul>" + "<h2>Style</h2>" + "<ul>" + "<li><a href='../../style/doc/concept.html'>Concept</a></li>" + "</ul>" + "<h2>Cell</h2>" + "<ul>" + "<li><a href='../../cell/doc/inlineEdit.html'>Inline Edit</a></li>" + "<li><a href='../../cell/doc/displayType.html'>Display Type</a></li>" + "<li><a href='../../cell/doc/customCell.html'>Custom Cell</a></li>" + "<li><a href='../../cell/doc/dataType.html'>Data Type</a></li>" + "</ul>" + "<h2>Data</h2>" + "<ul>" + "<li><a href='../../data/doc/defaults.html'>Defaults</a></li>" + "<li><a href='../../data/doc/expression_format.html'>Expression</a></li>" + "<li><a href='../../data/doc/processData.html'>Process Data</a></li>" + "</ul>" + "<h2>Sort</h2>" + "<ul>" + "<li><a href='../../sort/doc/sort.html'>Sort</a></li>" + "</ul>");
        if (menuName === "Sample") {
            lnb.append(menuList);
        }
    </script>
</body>

</html>